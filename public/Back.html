<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="icon-192.png" type="image/png">
  <title>BMO — Спина</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #fffbeb;
      color: #333;
      line-height: 1.6;
      padding: 20px;
      min-height: 100vh;
    }

    /* ЕДИНЫЙ ПЕРЕКЛЮЧАТЕЛЬ ЯЗЫКА */
    .lang-switch {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      background: rgba(255,255,255,0.9);
      backdrop-filter: blur(10px);
      border-radius: 30px;
      padding: 8px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      display: flex;
      gap: 8px;
    }
    .lang-btn {
      padding: 10px 18px;
      border: none;
      background: transparent;
      font-weight: bold;
      font-size: 16px;
      cursor: pointer;
      border-radius: 25px;
      transition: all 0.3s;
    }
    .lang-btn.active {
      background: #0ea5e9;
      color: white;
    }
    .lang-btn:hover:not(.active) { background: rgba(14,165,233,0.2); }

    header {
      background: linear-gradient(135deg, #f59e0b, #fbbf24);
      color: white;
      text-align: center;
      padding: 50px 20px;
      border-radius: 16px;
      margin-bottom: 20px;
    }
    h1 { font-size: 2.8rem; margin-bottom: 10px; }

    .container {
      max-width: 880px;
      margin: 0 auto;
      background: white;
      border-radius: 20px;
      box-shadow: 0 15px 45px rgba(0,0,0,0.12);
      padding: 40px;
    }
    .section { margin-bottom: 32px; }
    label { font-size: 1.15rem; font-weight: 600; display: block; margin-bottom: 10px; }
    select, button {
      width: 100%; padding: 16px; margin: 12px 0; border-radius: 12px; border: 1px solid #ccc; font-size: 16px;
    }
    button {
      background: #f59e0b; color: white; border: none; font-weight: bold; cursor: pointer; transition: 0.3s;
    }
    button:hover { background: #d97706; }

    .recommendation {
      background: #fffbeb; padding: 24px; border-radius: 12px; margin-top: 25px;
      border-left: 6px solid #f59e0b; font-size: 1.05rem; line-height: 1.7;
    }
    .warning {
      color: #991b1b; font-weight: bold; font-size: 1.35rem;
      background: #fee2e2; padding: 16px; border-radius: 10px; margin: 15px 0; text-align: center;
    }
    footer {
      text-align: center; padding: 30px; background: #fffbeb;
      border-radius: 16px; margin-top: 40px; color: #555;
    }
  </style>
</head>
<body>

  <!-- Переключатель языка -->
  <div class="lang-switch">
    <button class="lang-btn" data-lang="ru">RU</button>
    <button class="lang-btn" data-lang="en">EN</button>
  </div>

  <header>
    <h1 data-ru="Спина – Где болит?" data-en="Back – Where Does It Hurt?">Спина – Где болит?</h1>
    <p data-ru="Помощник при боли в спине и пояснице<br><strong>Невозможность встать + недержание мочи/кала + онемение в ногах → СКОРАЯ 103!</strong>"
       data-en="Back & low back pain helper<br><strong>Inability to stand + urinary/bowel incontinence + leg numbness → CALL 911 NOW!</strong>">
    </p>
  </header>

  <div class="container">

    <div class="section">
      <label data-ru="Локализация и характер боли:" data-en="Location and type of pain:">Локализация и характер боли:</label>
      <select id="painType">
        <option value="upper"     data-ru="Верх спины / между лопатками" data-en="Upper back / between shoulder blades"></option>
        <option value="mid"       data-ru="Грудной отдел (середина спины)" data-en="Mid-thoracic (middle back)"></option>
        <option value="lower"     data-ru="Поясница (ниже рёбер)" data-en="Lumbar (lower back)"></option>
        <option value="radiating" data-ru="Отдаёт в ногу / ягодицу" data-en="Radiates to leg / buttock"></option>
        <option value="danger"    data-ru="Резкая + онемение ног + проблемы с мочеиспусканием" data-en="Sudden + leg numbness + bladder/bowel issues"></option>
        <option value="other"     data-ru="Другая / хроническая" data-en="Other / chronic"></option>
      </select>
    </div>

    <div class="section">
      <label data-ru="Вероятная причина:" data-en="Likely cause:">Вероятная причина:</label>
      <select id="disease">
        <!-- Верх спины -->
        <option value="posture"     data-type="upper" data-ru="Плохая осанка / сколиоз" data-en="Poor posture / scoliosis"></option>
        <option value="myofascial"  data-type="upper" data-ru="Миофасциальный синдром" data-en="Myofascial pain syndrome"></option>

        <!-- Грудной отдел -->
        <option value="thoracic_osteo" data-type="mid" data-ru="Грудной остеохондроз" data-en="Thoracic osteochondrosis"></option>
        <option value="scheuermann"   data-type="mid" data-ru="Болезнь Шейермана-Мау" data-en="Scheuermann's disease"></option>

        <!-- Поясница -->
        <option value="lumbago"      data-type="lower" data-ru="Прострел (люмбаго)" data-en="Lumbago (acute low back pain)"></option>
        <option value="lumbar_osteo" data-type="lower" data-ru="Поясничный остеохондроз" data-en="Lumbar osteochondrosis"></option>
        <option value="facet"        data-type="lower" data-ru="Фасеточный синдром" data-en="Facet joint syndrome"></option>

        <!-- Иррадиирующая -->
        <option value="sciatica" data-type="radiating" data-ru="Ишиас / радикулит" data-en="Sciatica / radiculopathy"></option>
        <option value="hernia"   data-type="radiating" data-ru="Грыжа диска L4-L5, L5-S1" data-en="Disc herniation L4-L5, L5-S1"></option>

        <!-- Красные флаги -->
        <option value="cauda_equina"    data-type="danger" data-ru="Синдром конского хвоста" data-en="Cauda equina syndrome"></option>
        <option value="fracture"        data-type="danger" data-ru="Компрессионный перелом" data-en="Vertebral compression fracture"></option>
        <option value="tumor_infection" data-type="danger" data-ru="Опухоль / инфекция" data-en="Tumor / infection / osteomyelitis"></option>

        <!-- Другое -->
        <option value="kidney"  data-type="other" data-ru="Проблемы с почками" data-en="Kidney problems (pyelonephritis, stone)"></option>
        <option value="unknown" data-type="other" data-ru="Неясная причина" data-en="Unclear cause"></option>
      </select>
    </div>

    <div class="section">
      <label data-ru="Интенсивность боли (0–10):" data-en="Pain intensity (0–10):">Интенсивность боли:</label>
      <select id="painLevel">
        <option value="0-4" data-ru="0–4 – терпимая" data-en="0–4 – tolerable"></option>
        <option value="5-7" data-ru="5–7 – сильная" data-en="5–7 – strong"></option>
        <option value="8-10" data-ru="8–10 – не даёт двигаться" data-en="8–10 – prevents movement"></option>
      </select>
    </div>

    <button onclick="showRecommendation()" data-ru="Показать рекомендации" data-en="Show recommendations">Показать рекомендации</button>

    <div style="text-align:center; margin:40px 0;">
      <button onclick="history.back()" style="background:#4b5563;color:white;padding:14px 36px;border:none;border-radius:12px;font-weight:bold;">
        <span data-ru="НАЗАД" data-en="BACK">НАЗАД</span>
      </button>
    </div>

    <div id="recommendation" class="recommendation" style="display:none;"></div>
  </div>

  <footer data-ru="© 2025 Мини-медицинская машина | Это не замена врачу!<br>При онемении в паху, недержании, слабости в ногах — немедленно в скорую!"
          data-en="© 2025 Mini Medical Assistant | Not a substitute for a doctor!<br>Perineal numbness, incontinence, leg weakness — call 911 immediately!">
  </footer>

  <!-- УНИВЕРСАЛЬНЫЙ СКРИПТ ПЕРЕВОДА -->
  <script>
    const langBtns = document.querySelectorAll('.lang-btn');
    const translatable = document.querySelectorAll('[data-ru][data-en]');

    let currentLang = 'ru';

    function updateAllTexts() {
      translatable.forEach(el => el.innerHTML = el.dataset[currentLang]);
      document.querySelectorAll('option[data-ru][data-en]').forEach(opt => opt.textContent = opt.dataset[currentLang]);
      document.title = document.querySelector('h1').dataset[currentLang] + ' — BMO';
      document.documentElement.lang = currentLang;
      filterDiseases();
    }

    function setLanguage(lang) {
      currentLang = lang;
      localStorage.setItem('lang', lang);
      langBtns.forEach(b => b.classList.toggle('active', b.dataset.lang === lang));
      updateAllTexts();
    }

    langBtns.forEach(btn => btn.addEventListener('click', () => setLanguage(btn.dataset.lang)));

    // Загружаем язык с главной страницы (или любой другой)
    currentLang = localStorage.getItem('lang') || 'ru';
    setLanguage(currentLang);

    function filterDiseases() {
      const type = document.getElementById('painType').value;
      const options = document.querySelectorAll('#disease option');

      let first = null;
      options.forEach(opt => {
        const show = opt.dataset.type === type || opt.dataset.type === 'other' || (opt.dataset.type === 'danger' && type === 'danger');
        opt.style.display = show ? 'block' : 'none';
        if (show && !first) first = opt;
      });
      if (first) document.getElementById('disease').value = first.value;
    }

    document.getElementById('painType').addEventListener('change', filterDiseases);

    // Рекомендации
    function showRecommendation() {
      const disease = document.getElementById('disease').value;
      const level = document.getElementById('painLevel').value;
      const isEn = currentLang === 'en';

      let rec = `<strong>${isEn ? 'Intensity' : 'Интенсивность'}:</strong> ${document.querySelector('#painLevel').selectedOptions[0].textContent}<br><br>`;

      const emergency = ['cauda_equina', 'fracture', 'tumor_infection'].includes(disease) ||
                        (document.getElementById('painType').value === 'danger') ||
                        (disease === 'hernia' && level === '8-10');

      if (emergency) {
        rec += isEn
          ? `<div class="warning">CALL 911 IMMEDIATELY!<br>Possible cauda equina syndrome, fracture or tumor!</div>`
          : `<div class="warning">ВЫЗЫВАЙТЕ СКОРУЮ 103/112 ПРЯМО СЕЙЧАС!<br>Это может быть синдром конского хвоста, перелом или опухоль!</div>`;
      } else if (level === '8-10') {
        rec += isEn
          ? `<div class="warning">Very severe pain — see a doctor within hours!</div>`
          : `<div class="warning">Острая невыносимая боль — к врачу в ближайшие часы!</div>`;
      }

      const advice = isEn ? {
        posture: "Poor posture:<br>• Exercise & swimming<br>• Ergonomic workplace<br>• Corset only temporarily",
        myofascial: "Myofascial syndrome:<br>• Massage, dry needling, stretching<br>• Diclofenac gel<br>• Muscle relaxants if needed",
        thoracic_osteo: "Thoracic osteochondrosis:<br>• NSAIDs (Meloxicam)<br>• Physiotherapy, exercise<br>• Massage",
        scheuermann: "Scheuermann's disease:<br>• Brace + exercise under orthopedist<br>• Swimming, back strengthening",
        lumbago: "Lumbago:<br>• 1–2 days rest, then movement<br>• Ibuprofen 600–800 mg ×3<br>• Topical gels (Fastum, Finalgon)",
        lumbar_osteo: "Lumbar osteochondrosis:<br>• NSAIDs + muscle relaxants<br>• B-vitamins<br>• Exercises (Bubnovsky/Dikul)",
        facet: "Facet joint syndrome:<br>• Facet joint block (if indicated)<br>• NSAIDs, physiotherapy",
        sciatica: "Sciatica:<br>• NSAIDs + B-vitamins<br>• Severe pain → MRI + neurologist",
        hernia: "Disc herniation:<br>• 90% resolve in 6–12 weeks<br>• NSAIDs, muscle relaxants, exercise<br>• Leg numbness → MRI urgently!",
        cauda_equina: "Cauda equina syndrome — CALL 911! Surgery within 48 hours!",
        fracture: "Compression fracture:<br>• Urgent MRI/CT + neurosurgeon<br>• Brace, rest",
        tumor_infection: "Tumor/infection of spine:<br>• Fever + night pain + weight loss → CALL 911!",
        kidney: "Kidney pain:<br>• Antispasmodics (No-Spa)<br>• Drink 2–3 L water<br>• See urologist + kidney ultrasound",
        unknown: "Unclear cause:<br>Start with neurologist + lumbar X-ray/MRI.<br>Until then: Ibuprofen + heat + light activity."
      } : {
        posture: "Плохая осанка:<br>• ЛФК и плавание<br>• Правильная эргономика<br>• Корсет только временно",
        myofascial: "Миофасциальный синдром:<br>• Массаж, сухая игла, растяжка<br>• Мази (Диклофенак, Вольтарен)<br>• Миорелаксанты при спазме",
        thoracic_osteo: "Грудной остеохондроз:<br>• НПВС (Мовалис, Аркоксия)<br>• Физиотерапия, ЛФК<br>• Массаж",
        scheuermann: "Болезнь Шейермана-Мау:<br>• Корсет + ЛФК у ортопеда<br>• Плавание, укрепление спины",
        lumbago: "Прострел (люмбаго):<br>• 1–2 дня покоя, затем движение<br>• Ибупрофен 600–800 мг ×3<br>• Местно: Финалгон, Фастум-гель",
        lumbar_osteo: "Поясничный остеохондроз:<br>• НПВС + миорелаксанты (Мидокалм)<br>• Витамины B<br>• ЛФК по Бубновскому/Дикулю",
        facet: "Фасеточный синдром:<br>• Блокада фасеточных суставов<br>• НПВС, физиотерапия",
        sciatica: "Ишиас / радикулит:<br>• НПВС + витамины B<br>• При сильной боли — МРТ + невролог",
        hernia: "Грыжа диска:<br>• 90% проходят за 6–12 недель<br>• НПВС, миорелаксанты, ЛФК<br>• При онемении ноги — МРТ срочно!",
        cauda_equina: "СИНДРОМ КОНСКОГО ХВОСТА — СКОРАЯ! Операция в первые 48 часов!",
        fracture: "Компрессионный перелом:<br>• СРОЧНО МРТ/КТ + к нейрохирургу<br>• Корсет, покой",
        tumor_infection: "Опухоль/инфекция позвоночника:<br>• Температура + ночная боль + потеря веса → СКОРАЯ!",
        kidney: "Боль от почек:<br>• Спазмолитики (Но-шпа)<br>• Питьё 2–3 л воды<br>• К урологу + УЗИ почек",
        unknown: "Неясная причина:<br>Начните с невролога + рентген/МРТ поясницы.<br>До визита: Ибупрофен + тепло + лёгкая активность."
      };

      const selectedText = document.querySelector('#disease').selectedOptions[0].textContent;
      rec += `<strong>${selectedText}:</strong><br>`;
      rec += advice[disease] || (isEn ? "See a neurologist or spine specialist soon." : "Обратитесь к неврологу или вертебрологу.");

      document.getElementById('recommendation').innerHTML = rec;
      document.getElementById('recommendation').style.display = 'block';
    }
  </script>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-analytics.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCx5luU29nUjrUxyqM50cH5hLS6hsc4KiI",
      authDomain: "bmo-001.firebaseapp.com",
      projectId: "bmo-001",
      storageBucket: "bmo-001.firebasestorage.app",
      messagingSenderId: "767001348534",
      appId: "1:767001348534:web:8a04b36126fa2253e35917",
      measurementId: "G-5Z6JJYQ92Q"
    };

    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
  </script>
</body>
</html>